<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Flexbox Proof of Concept</title>
    <link href="https://fonts.googleapis.com/css?family=PT+Mono|Roboto+Condensed&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.18.1/build/cssnormalize/cssnormalize-min.css">
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main>
      <section class="twenty">
        <h2>Welcome!</h2>
        <p class="desc">You are the coach of a sports team! Using <a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_blank">flexbox</a> get your players where you need them on the pitch!</p>
        <p>Go get em!</p>
        <div class="input">
            <div class="hold-input">
                <label for="parent-input">.flex-parent <span class="color-embellish">{</span></label>
                <div>
              <textarea class="code-input" id="parent-input"></textarea>
            </div>
              <p class="code-input-after"><span class="color-embellish">}</span></p>
            </div>
            <div class="hold-input">
              <label for="child-input">.flex-child <span class="color-embellish">{</span></label>
                <div>
              <textarea class="code-input" id="child-input" ></textarea>
            </div>
              <div>
                <p class="code-input-after"><span class="color-embellish">}</span></p>
              </div>
            </div>
          </div>
      </section>
      <section class="eighty">
        <section class="playing-field">
          <div class="flex-parent-guide">
            <div class="flex-child-guide"></div>
            <div class="flex-child-guide"></div>
            <div class="flex-child-guide"></div>
            <div class="flex-child-guide"></div>
          </div>
          <div class="flex-parent">
            <div class="flex-child">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                height="90px"
                width="80px"
                version="1.1"
                x="0px"
                y="0px"
                viewBox="0 0 100 296.47875"
                style="enable-background:new 0 0 100.013 237.183;"
                xml:space="preserve"
              >
                <g>
                  <path
                    stroke="black"
                    fill="cornflowerblue"
                    d="M8.57,146.426c0.157,0,0.316-0.004,0.475-0.014c4.411-0.258,7.777-4.043,7.519-8.454   c-1.675-28.633,0.659-46.371,3.999-56.989c1.369-11.395,1.032-20.959,0.4-27.489c-1.509,0.872-3.081,1.997-4.667,3.487   C3.404,69.081-1.88,96.644,0.591,138.893C0.84,143.145,4.365,146.426,8.57,146.426z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M83.449,137.958c-0.258,4.411,3.108,8.196,7.519,8.454c0.159,0.009,0.317,0.014,0.475,0.014   c4.205,0,7.73-3.281,7.979-7.533c2.472-42.248-2.813-69.811-15.706-81.925c-1.584-1.488-3.154-2.612-4.662-3.485   c-0.632,6.536-0.969,16.107,0.398,27.494C82.791,91.597,85.123,109.333,83.449,137.958z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M50.006,64.766c6.278,0,11.455-6.181,12.064-14.068H37.943C38.551,58.585,43.729,64.766,50.006,64.766z"
                  />
                  <path
                  stroke="black"
                    fill="maroon"
                    d="M47.689,134.548h4.635v31.469h24.729V85.588c-2.188-14.296-1.711-26.074-0.902-33.521   c-2.614-1.032-4.849-1.309-6.341-1.344c-0.161-0.01-0.322-0.025-0.485-0.025h-4.257c-0.646,9.542-7.148,17.068-15.061,17.068   s-14.415-7.525-15.061-17.068h-4.256c-0.163,0-0.323,0.014-0.484,0.024c-1.492,0.035-3.727,0.311-6.343,1.344   c0.809,7.446,1.286,19.224-0.901,33.519v80.431h24.729V134.548z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M35.324,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H22.961v54.803C22.961,231.649,28.498,237.183,35.324,237.183z   "
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M64.687,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H52.324v54.803C52.324,231.649,57.861,237.183,64.687,237.183z   "
                  />
                  <circle
                  stroke="black"
                    fill="cornflowerblue"
                    cx="50.007"
                    cy="22.5"
                    r="22.5"
                  />
                </g>
              </svg>
            </div>
            <div class="flex-child">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                height="90px"
                width="90px"
                version="1.1"
                x="0px"
                y="0px"
                viewBox="0 0 100.013 296.47875"
                style="enable-background:new 0 0 100.013 237.183;"
                xml:space="preserve"
              >
                <g>
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M8.57,146.426c0.157,0,0.316-0.004,0.475-0.014c4.411-0.258,7.777-4.043,7.519-8.454   c-1.675-28.633,0.659-46.371,3.999-56.989c1.369-11.395,1.032-20.959,0.4-27.489c-1.509,0.872-3.081,1.997-4.667,3.487   C3.404,69.081-1.88,96.644,0.591,138.893C0.84,143.145,4.365,146.426,8.57,146.426z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M83.449,137.958c-0.258,4.411,3.108,8.196,7.519,8.454c0.159,0.009,0.317,0.014,0.475,0.014   c4.205,0,7.73-3.281,7.979-7.533c2.472-42.248-2.813-69.811-15.706-81.925c-1.584-1.488-3.154-2.612-4.662-3.485   c-0.632,6.536-0.969,16.107,0.398,27.494C82.791,91.597,85.123,109.333,83.449,137.958z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M50.006,64.766c6.278,0,11.455-6.181,12.064-14.068H37.943C38.551,58.585,43.729,64.766,50.006,64.766z"
                  />
                  <path
                  stroke="black"
                    fill="orange"
                    d="M47.689,134.548h4.635v31.469h24.729V85.588c-2.188-14.296-1.711-26.074-0.902-33.521   c-2.614-1.032-4.849-1.309-6.341-1.344c-0.161-0.01-0.322-0.025-0.485-0.025h-4.257c-0.646,9.542-7.148,17.068-15.061,17.068   s-14.415-7.525-15.061-17.068h-4.256c-0.163,0-0.323,0.014-0.484,0.024c-1.492,0.035-3.727,0.311-6.343,1.344   c0.809,7.446,1.286,19.224-0.901,33.519v80.431h24.729V134.548z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M35.324,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H22.961v54.803C22.961,231.649,28.498,237.183,35.324,237.183z   "
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M64.687,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H52.324v54.803C52.324,231.649,57.861,237.183,64.687,237.183z   "
                  />
                  <circle
                  stroke="black"
                    fill="cornflowerblue"
                    cx="50.007"
                    cy="22.5"
                    r="22.5"
                  />
                </g>
              </svg>
            </div>
            <div class="flex-child">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                height="90px"
                width="90px"
                version="1.1"
                x="0px"
                y="0px"
                viewBox="0 0 100.013 296.47875"
                style="enable-background:new 0 0 100.013 237.183;"
                xml:space="preserve"
              >
                <g>
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M8.57,146.426c0.157,0,0.316-0.004,0.475-0.014c4.411-0.258,7.777-4.043,7.519-8.454   c-1.675-28.633,0.659-46.371,3.999-56.989c1.369-11.395,1.032-20.959,0.4-27.489c-1.509,0.872-3.081,1.997-4.667,3.487   C3.404,69.081-1.88,96.644,0.591,138.893C0.84,143.145,4.365,146.426,8.57,146.426z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M83.449,137.958c-0.258,4.411,3.108,8.196,7.519,8.454c0.159,0.009,0.317,0.014,0.475,0.014   c4.205,0,7.73-3.281,7.979-7.533c2.472-42.248-2.813-69.811-15.706-81.925c-1.584-1.488-3.154-2.612-4.662-3.485   c-0.632,6.536-0.969,16.107,0.398,27.494C82.791,91.597,85.123,109.333,83.449,137.958z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M50.006,64.766c6.278,0,11.455-6.181,12.064-14.068H37.943C38.551,58.585,43.729,64.766,50.006,64.766z"
                  />
                  <path
                  stroke="black"
                    fill="orange"
                    d="M47.689,134.548h4.635v31.469h24.729V85.588c-2.188-14.296-1.711-26.074-0.902-33.521   c-2.614-1.032-4.849-1.309-6.341-1.344c-0.161-0.01-0.322-0.025-0.485-0.025h-4.257c-0.646,9.542-7.148,17.068-15.061,17.068   s-14.415-7.525-15.061-17.068h-4.256c-0.163,0-0.323,0.014-0.484,0.024c-1.492,0.035-3.727,0.311-6.343,1.344   c0.809,7.446,1.286,19.224-0.901,33.519v80.431h24.729V134.548z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M35.324,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H22.961v54.803C22.961,231.649,28.498,237.183,35.324,237.183z   "
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M64.687,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H52.324v54.803C52.324,231.649,57.861,237.183,64.687,237.183z   "
                  />
                  <circle
                  stroke="black"
                    fill="cornflowerblue"
                    cx="50.007"
                    cy="22.5"
                    r="22.5"
                  />
                </g>
              </svg>
            </div>
            <div class="flex-child">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                height="90px"
                width="90px"
                version="1.1"
                x="0px"
                y="0px"
                viewBox="0 0 100.013 296.47875"
                style="enable-background:new 0 0 100.013 237.183;"
                xml:space="preserve"
              >
                <g>
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M8.57,146.426c0.157,0,0.316-0.004,0.475-0.014c4.411-0.258,7.777-4.043,7.519-8.454   c-1.675-28.633,0.659-46.371,3.999-56.989c1.369-11.395,1.032-20.959,0.4-27.489c-1.509,0.872-3.081,1.997-4.667,3.487   C3.404,69.081-1.88,96.644,0.591,138.893C0.84,143.145,4.365,146.426,8.57,146.426z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M83.449,137.958c-0.258,4.411,3.108,8.196,7.519,8.454c0.159,0.009,0.317,0.014,0.475,0.014   c4.205,0,7.73-3.281,7.979-7.533c2.472-42.248-2.813-69.811-15.706-81.925c-1.584-1.488-3.154-2.612-4.662-3.485   c-0.632,6.536-0.969,16.107,0.398,27.494C82.791,91.597,85.123,109.333,83.449,137.958z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M50.006,64.766c6.278,0,11.455-6.181,12.064-14.068H37.943C38.551,58.585,43.729,64.766,50.006,64.766z"
                  />
                  <path
                  stroke="black"
                    fill="orange"
                    d="M47.689,134.548h4.635v31.469h24.729V85.588c-2.188-14.296-1.711-26.074-0.902-33.521   c-2.614-1.032-4.849-1.309-6.341-1.344c-0.161-0.01-0.322-0.025-0.485-0.025h-4.257c-0.646,9.542-7.148,17.068-15.061,17.068   s-14.415-7.525-15.061-17.068h-4.256c-0.163,0-0.323,0.014-0.484,0.024c-1.492,0.035-3.727,0.311-6.343,1.344   c0.809,7.446,1.286,19.224-0.901,33.519v80.431h24.729V134.548z"
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M35.324,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H22.961v54.803C22.961,231.649,28.498,237.183,35.324,237.183z   "
                  />
                  <path
                  stroke="black"
                    fill="cornflowerblue"
                    d="M64.687,237.183c6.828,0,12.365-5.533,12.365-12.363v-54.803H52.324v54.803C52.324,231.649,57.861,237.183,64.687,237.183z   "
                  />
                  <circle
                  stroke="black"
                    fill="cornflowerblue"
                    cx="50.007"
                    cy="22.5"
                    r="22.5"
                  />
                </g>
              </svg>
            </div>
          </div>
        </section>
        <div class="good-job">
          <h2>Great work! You've beat the level.</h2>
          <p>Next one?</p>
          <button type="button" id="next">Ready!</button>
        </div>
      </section>
    </main>
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <script>
      const questions = {
        levelThree: {
          rules: "display: flex; justify-content: center",
          separatedRules: ["display:", "flex;", "justify-content:", "center;"],
          numberOfElements: 4
        },
        levelOne: {
          rules: "display: flex; flex-direction: column; align-items: flex-end",
          numberOfElements: 4
        },
        levelTwo: {
          rules: "display: flex",
          childRules: {
            element: 2,
            style: "align-self: flex-end"
          }
        },
        levelFour: {
          rules: "display: flex, flex-direction: row-reverse;",
        }
      };
      const LS_KEY = "juno-football-flexbox";
      const questionOrder = ["levelOne", "levelTwo", "levelThree", "levelFour"];
      let currentQuestion = 0;
      const inputListener = () => {
        $("#parent-input").on("input", e => {
          reStyleParentContainer(e.target.value);
        });
        $("#child-input").on("input", e => {
          reStyleChildElements(e.target.value);
        });
      };

      const reStyleParentContainer = styles => {
        saveToLocalStorage("parent", styles);
        $(".flex-parent").attr("style", styles);
        checkForCompletion();
      };
      const reStyleChildElements = styles => {
        const currentQuestionData = getCurrentQuestionData();
        console.log(currentQuestionData, 'say what?');
        if (!currentQuestionData.childRules) return;
        saveToLocalStorage("child", styles);
        const { element, style } = currentQuestionData.childRules;
        $(".flex-child").each((index, el) => {
          if (index === element) {
            $(el).attr("style", styles);
          }
        });
        checkForCompletion();
      };
      const checkForCompletion = () => {
        let matched = 0;
        $(".flex-child-guide").each((index, el) => {
          const bounds = el.getBoundingClientRect();
          const { x, y } = bounds;
          $(".flex-child").each((_, child) => {
            const childBounds = child.getBoundingClientRect();
            const { x: childX, y: childY } = childBounds;
            if (childX === x && childY === y) {
              matched = matched + 1;
            }
          });
        });
        if (matched === 4) {
          congratulatePlayer();
        }
      };

      const congratulatePlayer = () => {
        $(".good-job").css("display", "block");
      };

      const goToNextQuestion = e => {
        console.log("next question");
        e.preventDefault();
        console.log("go to next uestions?");
        currentQuestion = currentQuestion + 1;
        saveToLocalStorage("currentQuestion", currentQuestion);
        const currentQuestionData = getCurrentQuestionData();
        console.log(currentQuestionData, "current question data");
        const { childRules, rules } = currentQuestionData;
        console.log(childRules, 'for guide children?');
        updateGuide(rules);
        updateGuideChildren(childRules);
      };

      const updateGuide = styles => {
        console.log(styles, "styled in update guide");
        $(".flex-parent-guide").attr("style", styles);
        resetStep();
      };

      const updateGuideChildren = rules => {
        if (!rules) return;
        const { element, style } = rules;
        $(".flex-child-guide").each((index, el) => {
          console.log('this be running??');
          console.log(style, 'this be defined?');
          if (index === element) {
            console.log('they ever equal eachother?');
            console.log(el, 'el?');
            $(el).attr("style", style);
          }
        });
      };

      const resetStep = () => {
        $(".good-job").css("display", "none");
        $("#parent-input").val("");
        $('#child-input').val("");
        $(".flex-parent").attr("style", "");
        $(".flex-child").attr("style", "");
        $(".flex-child-guide").attr("style", "");
      };

      const initiateFirstQuestion = questionNumber => {
        const firstParentStyles = questions[questionNumber].rules;
        const firstChildStyles = questions[questionNumber].childRules;
        updateGuide(firstParentStyles);
        updateGuideChildren(firstChildStyles);
      };

      const getCurrentQuestionData = () => {
        console.log("in get current", currentQuestion);
        const currentLabel = questionOrder[currentQuestion];
        console.log("current label??", currentLabel);
        return questions[currentLabel];
      };

      const saveToLocalStorage = (key, data) => {
        const toSetKey = `${LS_KEY}-${currentQuestion}-${key}`;
        localStorage.setItem(toSetKey, data);
      };
      const getFromLocalStorage = key => {
        const toGetKey = `${LS_KEY}-${currentQuestion}-${key}`;
        return localStorage.getItem(toGetKey);
      };
      // TODO:
      // implement local storage retrieval.
      // implement back functionality
      $(function() {
        inputListener();
        initiateFirstQuestion("levelOne");
        $("#next").on("click", goToNextQuestion);
      });
    </script>
  </body>
</html>
